# WorkingDirectory is /home/{{ project_name }} so celery -A app can find the app/ module
[Unit]
Description=Celery Beat Scheduler for {{ project_name }}
After=network.target redis.service

[Service]
Type=simple
User={{ project_name }}
Group={{ project_name }}
WorkingDirectory=/home/{{ project_name }}
EnvironmentFile=-/home/{{ project_name }}/.env
ExecStart=/home/{{ project_name }}/venv/bin/celery -A {{ app_module }} beat \
    --loglevel={{ loglevel }} \
    --pidfile=/home/{{ project_name }}/celerybeat.pid \
    --schedule=/home/{{ project_name }}/{{ schedule_file }}
ExecStop=/bin/kill -TERM $MAINPID
Restart=always
RestartSec=10
StandardOutput=append:/var/log/projects/{{ project_name }}/celery-beat.log
StandardError=append:/var/log/projects/{{ project_name }}/celery-beat.log

[Install]
WantedBy=multi-user.target
